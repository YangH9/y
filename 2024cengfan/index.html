<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>2024届三（三）班毕业同学蹭饭圈</title>
    <script src="../js/echarts.js"></script>
    <script src="../js/map/js/china.js"></script>
    <style>
      * {
        margin: 0;
        padding: 0;
      }
      #main {
        width: 1920px;
        height: 1080px;
        overflow: hidden;
      }
    </style>
  </head>
  <body>
    <div id="main"></div>
    <script type="text/javascript">
      const myChart = echarts.init(document.querySelector('#main'))

      // console.log(
      //   echarts
      //     .getMap('china')
      //     .geoJSON.features.map(item => item.properties)
      //     .sort((a, b) => a.id - b.id)
      //     .map(i => ({ name: i.name, lng: i.cp[0], lat: i.cp[1] }))
      // )

      // 文字颜色
      const textColor = '#000'
      // 对齐空格
      const nbsp = Array.from({ length: 17 }, () => ' ').join('')

      // 成员数据，姓名、地区、学校
      const memberData = [
        { name: '于成凯', province: '河南', school: '河南师范大学' },
        { name: '刘兴', province: '河南', school: '河南师范大学' },
        { name: '薛奕康', province: '河南', school: '河南师范大学' },
        { name: '杨华宇', province: '河南', school: '河南农业大学' },
        { name: '杨天豪', province: '河南', school: '洛阳理工学院' },
        { name: '齐奥宇', province: '河南', school: '河南工程学院' },
        { name: '黄俊丰', province: '河南', school: '河南工程学院' },
        { name: '张佳洺', province: '河南', school: '新乡学院' },
        { name: '程元旭', province: '河南', school: '新乡工程学院' },
        { name: '陶宇飞', province: '河南', school: '新乡工程学院' },
        { name: '李丞成', province: '河南', school: '新乡工程学院' },
        { name: '郑佳钦', province: '河南', school: '南阳理工学院' },
        { name: '刘旭腾', province: '河南', school: '新乡医学院' },
        { name: '余沛炯', province: '河南', school: '河南体育学院' },
        { name: '马英浩', province: '河南', school: '安阳学院' },
        { name: '魏雪斌', province: '河南', school: '安阳学院' },
        { name: '刘文韬', province: '河南', school: '信阳学院' },
        { name: '齐博文', province: '河南', school: '信阳学院' },
        { name: '池银旭', province: '河南', school: '焦作大学' },
        { name: '张丛银', province: '河南', school: '焦作大学' },
        { name: '薛鹏程', province: '河南', school: '郑州科技学院' },
        { name: '朱贝贝', province: '河南', school: '商丘工学院' },
        { name: '程轩昂', province: '河南', school: '郑州经贸学院' },
        { name: '李涵叡', province: '河南', school: '郑州经贸学院' },
        { name: '高志延', province: '河南', school: '郑州商学院' },
        { name: '张帅', province: '河南', school: '郑州西亚斯学院' },
        { name: '张成龙', province: '河南', school: '郑州西亚斯学院' },
        { name: '赵鹏飞', province: '河南', school: '郑州工业应用技术学院' },
        { name: '晏绍伦', province: '河南', school: '黄河水利职业技术学院' },
        { name: '程志远', province: '河南', school: '郑州航空工业管理学院' },
        { name: '冯耀(定向士官)', province: '河南', school: '河南交通职业技术学院' },
        { name: '孙浩先', province: '河南', school: '郑州工业应用技术学院' },
        { name: '姚寓孔', province: '河南', school: '郑州电力高等专科学校' },
        { name: '高佳旭', province: '河南', school: '周口职业技术学院' },
        { name: '刘梦怡', province: '河南', school: '河南信息统计职业学院' },
        { name: '万雪婷', province: '河南', school: '南阳医学高等专科学校' },
        { name: '马祖壮', province: '河南', school: '南阳医学高等专科学校' },
        { name: '白伊伦', province: '河南', school: '南阳农业职业学院' },
        { name: '杨锟', province: '湖北', school: '长江大学' },
        { name: '耿照昂', province: '湖北', school: '湖北经济学院' },
        { name: '吕文凯', province: '湖北', school: '湖北汽车工业学院' },
        { name: '张苗(定向士官)', province: '湖北', school: '湖北交通职业技术学院' },
        { name: '赵衡', province: '江苏', school: '金陵科技学院' },
        { name: '彭雅松', province: '福建', school: '厦门华厦学院' },
        { name: '丁晓帆', province: '广西', school: '桂林学院' },
        { name: '李闯', province: '广西', school: '广西电力职业技术学院' },
        { name: '梅璇', province: '吉林', school: '吉林师范大学' },
        { name: '马习馨', province: '吉林', school: '吉林外国语大学' },
        { name: '李晨阳', province: '吉林', school: '吉林工程技术师范学院' },
        { name: '杨婉雪', province: '吉林', school: '长春财经学院' },
        { name: '薛晓冰', province: '重庆', school: '重庆旅游职业学院' },
        { name: '于松', province: '宁夏', school: '宁夏师范大学' },
        { name: '刘一鸣', province: '辽宁', school: '沈阳农业大学' },
        { name: '刘靖博', province: '辽宁', school: '辽宁科技学院' },
        { name: '周子琦', province: '北京', school: '北京邮电大学世纪学院' },
        { name: '樊浩宇', province: '山西', school: '山西工学院' },
        { name: '胡伟康', province: '贵州', school: '六盘水师范学院' },
        { name: '李晓锐', province: '海南', school: '海南科技职业大学' },
        { name: '王达飞', province: '新疆', school: '喀什大学' },
        { name: '王梦', province: '广东', school: '广东财贸职业学院' }
      ]

      // 省份数据，省份名称，省会名称，省会经度、纬度，省份标签位置
      const provinceData = [
        { name: '北京', lng: 116.3683244, lat: 39.915085, labelLng: 105, labelLat: 40, align: 'right', verticalAlign: 'bottom' },
        { name: '天津', lng: 117.190182, lat: 39.125596, labelLng: 0, labelLat: 0 },
        { name: '河北', lng: 114.502461, lat: 38.045474, labelLng: 0, labelLat: 0 },
        { name: '山西', lng: 112.549248, lat: 37.857014, labelLng: 95, labelLat: 35, verticalAlign: 'bottom' },
        { name: '内蒙古', lng: 111.670801, lat: 40.818311, labelLng: 0, labelLat: 0 },
        { name: '辽宁', lng: 123.429096, lat: 41.796767, labelLng: 117, labelLat: 30, align: 'left', verticalAlign: 'top' },
        { name: '吉林', lng: 125.3245, lat: 43.886841, labelLng: 120, labelLat: 42, align: 'left', verticalAlign: 'bottom' },
        { name: '黑龙江', lng: 126.642464, lat: 45.756967, labelLng: 0, labelLat: 0 },
        { name: '上海', lng: 121.490317, lat: 31.222771, labelLng: 0, labelLat: 0 },
        { name: '江苏', lng: 118.767413, lat: 32.041544, labelLng: 117, labelLat: 22, align: 'left' },
        { name: '浙江', lng: 120.153576, lat: 30.287459, labelLng: 0, labelLat: 0 },
        { name: '安徽', lng: 117.283042, lat: 31.86119, labelLng: 0, labelLat: 0 },
        { name: '福建', lng: 119.306239, lat: 26.075302, labelLng: 115, labelLat: 7 },
        { name: '江西', lng: 115.892151, lat: 28.676493, labelLng: 0, labelLat: 0 },
        { name: '山东', lng: 117.000923, lat: 36.675807, labelLng: 0, labelLat: 0 },
        { name: '河南', lng: 113.665412, lat: 34.757975, labelLng: 130, labelLat: 25 },
        { name: '湖北', lng: 114.29857, lat: 30.584355, labelLng: 114, labelLat: 17, align: 'left', verticalAlign: 'middle' },
        { name: '湖南', lng: 112.982279, lat: 28.19409, labelLng: 0, labelLat: 0 },
        { name: '广东', lng: 113.280637, lat: 23.125178, labelLng: 100, labelLat: 5 },
        { name: '广西', lng: 108.320004, lat: 22.82402, labelLng: 85, labelLat: 10, verticalAlign: 'top' },
        { name: '海南', lng: 109.83119, lat: 20.031971, labelLng: 90, labelLat: 5, verticalAlign: 'top' },
        { name: '重庆', lng: 108.380246, lat: 30.807807, labelLng: 70, labelLat: 17 },
        { name: '四川', lng: 104.065735, lat: 30.659462, labelLng: 0, labelLat: 0 },
        { name: '贵州', lng: 106.713478, lat: 26.578343, labelLng: 75, labelLat: 13 },
        { name: '云南', lng: 102.712251, lat: 25.040609, labelLng: 0, labelLat: 0 },
        { name: '西藏', lng: 91.132212, lat: 29.660361, labelLng: 0, labelLat: 0 },
        { name: '陕西', lng: 108.948024, lat: 34.263161, labelLng: 0, labelLat: 0 },
        { name: '甘肃', lng: 103.823557, lat: 36.058039, labelLng: 0, labelLat: 0 },
        { name: '青海', lng: 101.778916, lat: 36.623178, labelLng: 0, labelLat: 0 },
        { name: '宁夏', lng: 106.278179, lat: 38.46637, labelLng: 63, labelLat: 25 },
        { name: '新疆', lng: 87.617733, lat: 43.792818, labelLng: 65, labelLat: 35 },
        { name: '台湾', lng: 121.559, lat: 25.0904, labelLng: 0, labelLat: 0 },
        { name: '香港', lng: 114.173355, lat: 22.320048, labelLng: 0, labelLat: 0 },
        { name: '澳门', lng: 113.54909, lat: 22.198951, labelLng: 0, labelLat: 0 },
        { name: '南海诸岛', lng: 0, lat: 0, labelLng: 0, labelLat: 0 }
      ]

      // 地图数据
      const mapData = provinceData.map(item => ({
        name: item.name,
        list: memberData.filter(i => i.province === item.name),
        value: memberData.filter(i => i.province === item.name).length
      }))

      // 文字标签数据
      const labelData = provinceData
        .map(item => {
          let obj = {
            name: item.name,
            coords: [
              [item.lng, item.lat],
              [item.labelLng + 10, item.labelLat + 10]
            ],
            list: memberData.filter(i => i.province === item.name),
            value: memberData.filter(i => i.province === item.name).length,
            label: {}
          }
          if (item.align) obj.label.align = item.align
          if (item.verticalAlign) obj.label.verticalAlign = item.verticalAlign
          return obj
        })
        .filter(item => item.value)

      // 指定图表的配置项和数据
      const option = {
        title: [
          {
            text: '2024届三（三）班毕业同学蹭饭圈',
            textStyle: { fontSize: 30, color: textColor },
            left: 'center',
            top: 20
          },
          {
            subtext: `班主任：张伟虎\n任课老师：语文：杨勇\n${nbsp}数学：朱海学\n${nbsp}日语：仲雅青、贾谭\n${nbsp}物理：张华\n${nbsp}化学：张伟虎\n${nbsp}生物：朱向克`,
            subtextStyle: { fontSize: 14, lineHeight: 20, color: textColor },
            left: 20,
            top: 20
          }
        ],
        toolbox: { feature: { saveAsImage: { show: true } }, iconStyle: { borderColor: textColor, borderWidth: 2 }, top: 20, right: 20 },
        // tooltip: {
        //   formatter: params => `${params.name} ${params.value}人<br>${params.data.list.map(i => `${i.name}-${i.school}`).join('<br>')}`
        // },
        visualMap: {
          // 地图深浅高亮
          min: 0,
          max: 10,
          left: 20,
          bottom: 20,
          seriesIndex: 0,
          textStyle: { color: textColor },
          calculable: true,
          outOfRange: { color: '#f2f2f2' },
          inRange: { color: ['#e0ffff', '#1790cf'] },
          show: true
        },
        geo: [
          {
            // 地图阴影
            map: 'china',
            aspectScale: 0.85,
            componentType: 'geo',
            layoutCenter: ['50%', '50%'], //地图位置
            layoutSize: '100%',
            itemStyle: {
              normal: {
                shadowColor: '#a5e7f0',
                shadowOffsetY: 10,
                shadowBlur: 120
              }
            },
            regions: [{ name: '南海诸岛', itemStyle: { normal: { opacity: 0 } } }]
          },
          {
            // 地图阴影
            map: 'china',
            aspectScale: 0.85,
            componentType: 'geo',
            layoutCenter: ['50%', '50%'], //地图位置
            layoutSize: '100%',
            itemStyle: {
              normal: {
                shadowColor: '#516b91',
                shadowOffsetX: 0,
                shadowOffsetY: 15,
                opacity: 0.5
              }
            },
            regions: [{ name: '南海诸岛', itemStyle: { normal: { opacity: 0 } } }]
          }
        ],
        series: [
          {
            // 基础地图
            type: 'map',
            mapType: 'china',
            aspectScale: 0.85,
            layoutCenter: ['50%', '50%'], //地图位置
            layoutSize: '100%',
            label: { normal: { show: true, color: textColor }, emphasis: { show: true, color: textColor }, formatter: params => (params.value ? `${params.name} ${params.value}人` : params.name) },
            itemStyle: {
              normal: { borderColor: '#cccccc', borderWidth: 1.5 },
              emphasis: { areaColor: '#afe8ff' }
            },
            data: mapData
          },
          {
            type: 'lines',
            symbol: 'circle',
            symbolSize: [10, 10],
            coordinateSystem: 'geo',
            z: 10,
            label: {
              show: true,
              padding: [10, 10],
              color: textColor,
              backgroundColor: '#fff',
              borderRadius: 10,
              borderColor: '#aaa',
              borderWidth: 1,
              formatter(params) {
                let list = params.data.list.map(i => `{name|${i.name}：}{school|${i.school}}`)
                list.unshift(`{title|${params.name}   ${params.value}人}`)
                return list.join('\n')
              },
              rich: {
                title: { fontSize: 14, fontWeight: 'bold', padding: [0, 0, 10, 0] },
                name: { fontSize: 12, lineHeight: 14, width: 90, align: 'left' },
                school: { fontSize: 14 }
              }
            },
            lineStyle: {
              color: '#aaa9',
              type: 'solid',
              width: 2,
              opacity: 1
            },
            data: labelData
          }
        ]
      }

      // 使用刚指定的配置项和数据显示图表。
      myChart.setOption(option)

      myChart.getZr().on('click', function (params) {
        // 控制台打印数据的名称
        console.log(params)
        let [longitude, latitude] = myChart.convertFromPixel('geo', [params.offsetX, params.offsetY])
        console.log(`labelLng:${longitude}, labelLat:${latitude}`)
      })
    </script>
  </body>
</html>
